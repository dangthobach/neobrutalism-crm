# jCasbin Model Configuration for IAM Service
# Supports RBAC with domains (multi-tenancy) and resource-based access control

[request_definition]
r = sub, dom, obj, act

[policy_definition]
p = sub, dom, obj, act

[role_definition]
g = _, _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g(r.sub, p.sub, r.dom) && r.dom == p.dom && keyMatch2(r.obj, p.obj) && regexMatch(r.act, p.act)

# Model explanation:
# - sub: Subject (userId)
# - dom: Domain (tenantId for multi-tenancy)
# - obj: Object/Resource (e.g., /api/customers/123, /api/content/*)
# - act: Action (GET, POST, PUT, DELETE, or READ, WRITE, DELETE)
#
# Example policies:
# p, role:admin, tenant1, /api/customers/*, (GET|POST|PUT|DELETE)
# p, role:user, tenant1, /api/customers/*, (GET)
# g, user123, role:admin, tenant1
#
# Example request:
# r = user123, tenant1, /api/customers/456, GET
# Result: Allow (user123 has role:admin in tenant1, admin can GET /api/customers/*)
