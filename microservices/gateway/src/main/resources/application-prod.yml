# Production Profile
spring:
  cloud:
    gateway:
      httpclient:
        wiretap: false  # Disable for performance
        pool:
          max-connections: 50000
          max-idle-time: 60s

      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins:
              - "https://app.yourdomain.com"
              - "https://admin.yourdomain.com"
            allowCredentials: true

  data:
    redis:
      cluster:
        nodes:
          - redis-node-1:6379
          - redis-node-2:6379
          - redis-node-3:6379
          - redis-node-4:6379
          - redis-node-5:6379
          - redis-node-6:6379
        max-redirects: 3
      password: ${REDIS_PASSWORD}
      lettuce:
        pool:
          max-active: 2000
          max-idle: 200
          min-idle: 50

  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: https://auth.yourdomain.com/realms/crm
          jwk-set-uri: https://auth.yourdomain.com/realms/crm/protocol/openid-connect/certs

# Strict settings for production
resilience4j:
  circuitbreaker:
    configs:
      default:
        slidingWindowSize: 200
        minimumNumberOfCalls: 20
        failureRateThreshold: 30
        waitDurationInOpenState: 30s

management:
  tracing:
    sampling:
      probability: 0.01  # 1% sampling in production

logging:
  level:
    root: WARN
    com.neobrutalism.crm.gateway: INFO
    org.springframework.cloud.gateway: INFO
    org.springframework.security: WARN

app:
  gateway:
    routing:
      strategy: ${ROUTING_STRATEGY:microservice}
      canary:
        enabled: ${CANARY_ENABLED:true}
    cache:
      jwt-validation:
        ttl: 300
        max-size: 500000
      permission-check:
        ttl: 300
        max-size: 200000
